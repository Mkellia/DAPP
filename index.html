<!DOCTYPE html>
<html>
<head>
  <title>My ERC-20 Token DApp</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    body { font-family: Arial; background: #eee; display: flex; justify-content: center; padding-top: 40px; }
    .box { background: white; padding: 24px; border-radius: 8px; width: 420px; }
    button { padding: 10px 20px; margin-top: 10px; background: green; color: white; border: none; border-radius: 6px; cursor: pointer; }
    input { width: 100%; padding: 8px; margin-top: 8px; border-radius: 6px; border: 1px solid #ccc; }
  </style>
</head>
<body>
<div class="box">
  <h2>ERC-20 Token DApp</h2>

  <button id="connectBtn">Connect Wallet</button>
  <p>Your Address: <span id="userAddress">Not connected</span></p>

  <h3>Check Token Balance</h3>
  <button id="balanceBtn">Get Balance</button>
  <p>Balance: <span id="balance">0</span></p>

  <h3>Transfer Tokens</h3>
  <input id="recipient" placeholder="Recipient address">
  <input id="amount" placeholder="Amount to send">
  <button id="sendBtn">Send</button>
</div>

<script>
  let provider, signer, contract;

  const TOKEN_ADDRESS = "0x1b500ea788959796af598109e7c8483d11839a7e";

  const ABI = [
    {"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"type":"function"},
    {"constant":false,"inputs":[{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transfer","outputs":[{"name":"success","type":"bool"}],"type":"function"}
  ];

  document.getElementById("connectBtn").onclick = async () => {
    if (window.ethereum) {
      try {
        const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
        provider = new ethers.providers.Web3Provider(window.ethereum);
        signer = provider.getSigner();
        contract = new ethers.Contract(TOKEN_ADDRESS, ABI, signer);

        document.getElementById("userAddress").innerText = accounts[0];
        alert("✅ Wallet Connected Successfully");
      } catch {
        alert("❌ Connection request was rejected. Try again and click Connect.");
      }
    } else alert("MetaMask not installed.");
  };

  document.getElementById("balanceBtn").onclick = async () => {
    if (!contract) return alert("Connect wallet first.");
    const address = await signer.getAddress();
    const bal = await contract.balanceOf(address);
    document.getElementById("balance").innerText = bal.toString();
  };

  document.getElementById("sendBtn").onclick = async () => {
    if (!contract) return alert("Connect wallet first.");
    const to = document.getElementById("recipient").value;
    const amount = document.getElementById("amount").value;
    if (!to || !amount) return alert("Enter both address and amount.");
    const tx = await contract.transfer(to, amount);
    alert("⏳ Transaction submitted. Please wait...");
    await tx.wait();
    alert("✅ Transfer successful!");
  };
</script>
</body>
</html>